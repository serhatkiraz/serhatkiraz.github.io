<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Serhat Kiraz</title>
<style>
  :root{
    --bg:#0b0b0d;
    --accent:#552583; /* mor */
    --accent2:#FDB927; /* altın */
    --ui-alpha:0.14;
    --ui-size:18vmin;
    --btn-size:18vmin;
  }

  html,body{height:100%;margin:0;padding:0;overflow:hidden;background:var(--bg);touch-action:none;-webkit-user-select:none;user-select:none;}
  /* world container: geniş dünya burada, kamera translate ile hareket eder */
  #world{position:absolute;left:0;top:0;height:100%;transform-origin:0 0;will-change:transform;}

  /* ground & platforms */
  #ground{position:absolute;left:0;bottom:0;height:12px;background:#222;width:100%;}
  .platform{position:absolute;background:var(--accent2);border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.6);}

  /* ball */
  #ball{position:absolute;border-radius:50%;
        width:64px;height:64px;
        background:radial-gradient(circle at 30% 30%, #7a43b0, var(--accent));
        box-shadow:inset -8px -8px 16px rgba(0,0,0,0.4),0 0 30px rgba(85,37,131,0.25);
        will-change:transform,left,top;}

  /* Labels */
  .label{position:absolute;color:#fff;font-family:Arial,Helvetica,sans-serif;font-weight:1000;text-align:center;text-shadow:0 2px 4px rgba(0,0,0,0.6);pointer-events:none;}

  /* Mobil kontrolleri gizle */
  .ctrl,
  .jump,
  .invisible-zone {
    display: none !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }









</style>
</head>
<body>


  <div id="world">
    <div id="ground"></div>
    <!-- platformlar ve label'lar script ile eklenecek -->
    <div id="ball"></div>
  </div>

<script>
/* ----------------- Ayarlar (burayı kolayca değiştir) ----------------- */
let WORLD_PAGES = 10;              // kaç ekran genişliği uzunluğunda dünya
let ballSize = 49;                 // başlangıç boyutu (px)
let gravity = 0.6;                 // yerçekimi
let friction = 0.93;              // hava sürtünmesi (1'e yakın)
let groundFriction = 0.93;         // yerdeki x sürtünmesi (0-1)
let moveSpeed = 0.5;               // tuşa/basılı tutmaya eklenen x ivme
let maxSpeed = 6;                 // maksimum x hız
let jumpForce = 20;                // zıplama kuvveti
let bounce = 0.25;                 // zıplama geri tepmesi
let gyroSensitivity = 0.1;         // gyroscope hassasiyeti
/* -------------------------------------------------------------------- */

const world = document.getElementById('world');
const ball = document.getElementById('ball');

const dismissWarning = document.getElementById('dismissWarning');

let w = window.innerWidth, h = window.innerHeight;
let worldWidth = w * WORLD_PAGES;
let worldHeight = h;
let scrollX = 0, maxScrollX = Math.max(0, worldWidth - w);

let ballX=0, ballY=0, vx=0, vy=0;
let isOnGround=false, onPlatform=null;
let keys = {left:false,right:false,up:false};

// Gyroscope değişkenleri
let beta = 0; // Telefonun öne/arkaya eğimi (front-to-back)
let gamma = 0; // Telefonun sola/sağa eğimi (left-to-right)
let isGyroAvailable = false;
let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

const platforms = [];
const platformW = Math.round(Math.max(200, w * 0.2));
const platformH = 18;

/* Prevent default scroll on touch move to avoid page bouncing */
document.addEventListener('touchmove', e => { e.preventDefault(); }, {passive:false});

/* Build world size and platforms */
function buildWorld(){
  w = window.innerWidth; h = window.innerHeight;
  worldWidth = Math.max(w * 2, w * WORLD_PAGES);
  world.style.width = worldWidth + 'px';
  world.style.height = h + 'px';
  maxScrollX = Math.max(0, worldWidth - w);

  // remove existing platforms
  platforms.forEach(p => { if(p.el) p.el.remove(); if(p.label) p.label.remove(); });
  platforms.length = 0;

  // positions (relative to worldWidth)
  const pos = [
    {x: worldWidth * 0.03, y: h * 0.78, text:'Hi!'},
    {x: worldWidth * 0.12, y: h * 0.55, text:"I am Serhat"},
    {x: worldWidth * 0.32, y: h * 0.75, text:'I am passionate about exploring new ideas'},
    {x: worldWidth * 0.52, y: h * 0.68, text:'I enjoy coding solid and unique apps'},
    {x: worldWidth * 0.72, y: h * 0.58, text:'This are my finished projects'},
    {x: worldWidth * 0.90, y: h * 0.48, text:'Feel free to contact me'}
  ];

  pos.forEach((p,i) => {
    const el = document.createElement('div');
    el.className='platform';
    el.style.width = platformW+'px';
    el.style.height = platformH+'px';
    el.style.left = p.x + 'px';
    el.style.top = p.y + 'px';
    world.appendChild(el);

    const label = document.createElement('div');
    label.className='label';
    label.style.left = p.x + 'px';
    label.style.top = (p.y - 70) + 'px';
    label.style.width = platformW + 'px';
    label.textContent = p.text;
    world.appendChild(label);

    platforms.push({x:p.x,y:p.y,width:platformW,height:platformH,el,label});
  });

  // ground width covers world
  const grd = document.getElementById('ground');
  grd.style.width = worldWidth + 'px';
  grd.style.left = '0px';
  grd.style.top = (h - 12) + 'px';
}

/* initialize ball on first platform */
function init(){
  buildWorld();
  ball.style.width = ball.style.height = ballSize + 'px';
  // place ball on first platform
  if(platforms[0]){
    ballX = platforms[0].x + (platforms[0].width/2) - ballSize/2;
    ballY = platforms[0].y - ballSize - 6;
  } else {
    ballX = 20; ballY = h/2;
  }
  
  // Gyroscope'u başlat
  initGyroscope();
  

  
  update(); 
  requestAnimationFrame(loop);
}

/* Gyroscope başlatma */
function initGyroscope() {
  if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
    // iOS 13+ için izin iste
    DeviceOrientationEvent.requestPermission()
      .then(permissionState => {
        if (permissionState === 'granted') {
          window.addEventListener('deviceorientation', handleOrientation);
          isGyroAvailable = true;
        } else {
          console.log('Gyroscope izni reddedildi');
          isGyroAvailable = false;
        }
      })
      .catch(console.error);
  } else if ('DeviceOrientationEvent' in window) {
    // Android ve diğer tarayıcılar
    window.addEventListener('deviceorientation', handleOrientation);
    isGyroAvailable = true;
  } else {
    console.log('Gyroscope desteklenmiyor');
    isGyroAvailable = false;
  }
}

/* Gyroscope verilerini işle */
function handleOrientation(event) {
  beta = event.beta;  // Öne/arkaya eğim (-180 to 180)
  gamma = event.gamma; // Sola/sağa eğim (-90 to 90)
  
  // Gamma değerini normalize et (-90 to 90 arası)
  // Telefon düz dururken gamma = 0
  // Sağa eğince pozitif, sola eğince negatif
  if (gamma !== null) {
    // Hassasiyeti ayarla
    let tilt = gamma * gyroSensitivity;
    
    // Eşik değerleri (küçük eğimleri yok say)
    const threshold = 2;
    if (Math.abs(tilt) > threshold) {
      if (tilt > 0) {
        // Sağa eğilmiş - sağa git
        keys.right = true;
        keys.left = false;
      } else {
        // Sola eğilmiş - sola git
        keys.left = true;
        keys.right = false;
      }
    } else {
      // Düz duruyor - hareket etme
      keys.left = false;
      keys.right = false;
    }
  }
}

/* camera keeps ball centered horizontally */
function updateCamera(){
  const target = ballX - (w/2) + (ballSize/2);
  scrollX = Math.max(0, Math.min(target, maxScrollX));
  world.style.transform = `translateX(${-scrollX}px)`;
}

/* update ball element */
function update(){
  ball.style.left = ballX + 'px';
  ball.style.top = ballY + 'px';
  ball.style.width = ball.style.height = Math.max(36, ballSize) + 'px';
}

/* collisions with platforms */
function checkPlatformCollision(p){
  const platTop = p.y, platBottom = p.y + p.height;
  const platLeft = p.x, platRight = p.x + p.width;
  const ballTop = ballY, ballBottom = ballY + ballSize;
  const ballLeft = ballX, ballRight = ballX + ballSize;

  // landing on top
  if(ballRight > platLeft && ballLeft < platRight && ballBottom > platTop && ballTop < platTop && vy > 0){
    ballY = platTop - ballSize;
    vy = -vy * bounce;
    onPlatform = p;
    isOnGround = false;
    return true;
  }
  // hit head under platform
  if(ballRight > platLeft && ballLeft < platRight && ballTop < platBottom && ballBottom > platBottom && vy < 0){
    ballY = platBottom;
    vy = -vy * bounce;
    return true;
  }
  // horizontal collisions (simple)
  if(ballBottom > platTop && ballTop < platBottom){
    if(ballRight > platLeft && ballLeft < platLeft && vx > 0){
      ballX = platLeft - ballSize; vx = -vx * bounce; return true;
    }
    if(ballLeft < platRight && ballRight > platRight && vx < 0){
      ballX = platRight; vx = -vx * bounce; return true;
    }
  }

  if(onPlatform === p && !(ballBottom === platTop)) onPlatform = null;
  return false;
}

/* main loop */
function loop(){
  // apply gravity & friction
  vy += gravity;
  vx *= friction;

  // apply control - artık gyroscope veya klavye kontrolü
  if(keys.left) vx -= moveSpeed;
  if(keys.right) vx += moveSpeed;

  // clamp speed
  vx = Math.max(-maxSpeed, Math.min(maxSpeed, vx));

  // integrate
  ballX += vx;
  ballY += vy;

  // platform collisions
  let hit = false;
  for(const p of platforms) { if(checkPlatformCollision(p)){ hit = true; break; } }

  if(!hit){
    const groundY = worldHeight - 12 - ballSize;
    if(ballY > groundY){
      ballY = groundY;
      vy = -vy * bounce;
      isOnGround = true; onPlatform = null;
      if(Math.abs(vy) < 0.5) vy = 0;
    } else {
      isOnGround = false;
    }
  }

  // simple world bounds
  if(ballX < 0){ ballX = 0; vx = -vx * bounce; }
  if(ballX > worldWidth - ballSize){ ballX = worldWidth - ballSize; vx = -vx * bounce; }
  if(ballY < 0){ ballY = 0; vy = -vy * bounce; }

  update();
  updateCamera();
  requestAnimationFrame(loop);
}

/* Ekrana dokununca zıplama */
document.addEventListener('touchstart', function(e) {
  e.preventDefault();
  if(isOnGround || onPlatform){ 
    vy = -jumpForce; 
    isOnGround=false; 
    onPlatform=null; 
  }
}, {passive: false});

/* Fare tıklaması ile de zıplama (PC için) */
document.addEventListener('mousedown', function(e) {
  if(isOnGround || onPlatform){ 
    vy = -jumpForce; 
    isOnGround=false; 
    onPlatform=null; 
  }
});

/* Klavye kontrolleri (PC için yedek) */
window.addEventListener('keydown', e => {
  if(e.key === 'ArrowLeft') keys.left = true;
  if(e.key === 'ArrowRight') keys.right = true;
  if(e.key === 'ArrowUp' || e.code === 'Space'){ 
    e.preventDefault(); 
    if(isOnGround || onPlatform){ 
      vy = -jumpForce; 
      isOnGround=false; 
      onPlatform=null; 
    } 
  }
});

window.addEventListener('keyup', e => {
  if(e.key === 'ArrowLeft') keys.left = false;
  if(e.key === 'ArrowRight') keys.right = false;
});


/* handle resize */
window.addEventListener('resize', ()=>{ buildWorld(); init(); });

/* start */
init();
</script>
</body>
</html>
